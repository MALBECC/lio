	MODULE ESP_FUNCT

	IMPLICIT NONE
	INTEGER, DIMENSION (0:39) :: POINTERLOW=(/1,9,17,25,33,41,49,56,64,72,79,86,93,100,107,113,119,125,131,137,143,149,155,161,&
        167,172,177,182,187,192,197,202,207,212,217,222,227,232,237,242/)
	INTEGER, DIMENSION (0:39) :: POINTERUP=(/8,16,24,32,40,48,55,63,71,78,85,92,99,106,112,118,124,130,136,142,148,154,160,166,&
        171,176,181,186,191,196,201,206,211,216,221,226,231,236,241,246/)
	DOUBLE PRECISION, PARAMETER, DIMENSION (0:6) :: HDAW_DAW_LARGE_COEF=(/0.5D0, 0.25D0, 0.375D0, 0.9375D0, 3.28125D0,         &
        14.765625D0, 81.2109375D0/)

        DOUBLE PRECISION, PARAMETER, DIMENSION (246) :: HDAW_SHORT_COEF=(/-2.227673357873D-16,-3.603041588494D-9, 5.641900599881D-1&
        ,-1.855716761667D-5,-3.758028089842D-1,-2.937263239086D-3, 1.586735773807D-1,-3.712362707925D-2, 1.654923320373D-6,        &
        -4.283673776908D-5, 5.646780085194D-1,-3.216632920741D-3,-3.626661648377D-1,-3.697874666458D-2, 2.103001701512D-1,         &
        -7.233313577516D-2,-4.909038422764D-4, 6.169678713757D-3, 5.309521767077D-1, 9.902446632012D-2,-5.497719612405D-1,         &
        1.699289458172D-1, 8.215358267937D-2,-3.800879631724D-2,-8.860184581188D-3, 8.182679610811D-2, 2.361899484096D-1,          &
        7.408443731368D-1,-1.393552470603D0, 8.398504617092D-1,-2.153157176716D-1, 1.898293835776D-2,-2.622864777452D-2,           &
        2.070481292278D-1,-1.517729522946D-1, 1.410375745664D0,-2.088589931697D0, 1.273821623264D0,-3.662054027830D-1,             &
        4.151758125850D-2, 7.652753217902D-2,-3.496979906426D-1, 1.142731303255D0,-2.641065409391D-1,-7.870989692331D-1,           &
        6.659477061060D-1,-2.082257760423D-1, 2.389272621700D-2, 4.634935721533D-1,-2.162775089324D0, 4.787745789535D0,            &
        -4.340108008393D0, 1.951017416635D0,-4.390388356211D-1, 3.981846570969D-2, 9.892135872598D-1,-4.311631180681D0,            &
        8.556855041877D0,-8.017503990110D0, 4.106390132111D0,-1.197913275632D0, 1.884269501482D-1,-1.248598098755D-2,              &
        4.508582229747D-1,-2.475021032343D0, 5.870952943693D0,-5.834804573043D0, 3.041872702481D0,-8.863349469112D-1,              &
        1.377496059452D-1,-8.952617645264D-3,-2.479150925527D0, 6.465442349154D0,-5.832144628726D0, 2.684557558935D0,              &
        -6.830155078836D-1, 9.186854104822D-2,-5.120121563474D-3,-2.550246682056D0, 6.663085650406D0,-6.057008239737D0,            &
        2.819123791215D0,-7.278168845029D-1, 9.975271609922D-2,-5.693960934877D-3,-1.437322524459D0, 4.244945032011D0,             &
        -3.866819653025D0, 1.760657886042D0,-4.399493394691D-1,5.797869518089D-2,-3.166941925883D-3, 4.326982515539D-2,            &
        1.278541925538D0,-1.389457146276D0, 6.567745067205D-1,-1.631568799154D-1, 2.094831465123D-2,-1.101922864715D-3,            &
        1.115286202567D0,-7.098356509943D-1, 1.477452918517D-1, 2.274875774917D-2,-1.601072077271D-2, 2.728999281923D-3,           &
        -1.616695274909D-4, 1.346851272697D0,-1.125834241251D0, 4.583884751028D-1,-1.007033665315D-1, 1.153266357142D-2,           &
        -5.427038297057D-4, 1.220883963156D0,-9.581085557663D-1, 3.690371210149D-1,-7.689811239270D-2, 8.360797545174D-3,          &
        -3.736140672117D-4, 1.079863694049D0,-7.816343308043D-1, 2.806819253411D-1,-5.477512389825D-2, 5.590565502644D-3,          &
        -2.348302397877D-4, 9.600857053756D-1,-6.404875010594D-1, 2.141383549717D-1,-3.908625281056D-2, 3.740753346938D-3,         &
        -1.475725788623D-4, 8.652746664820D-1,-5.349723088368D-1, 1.671594028443D-1,-2.862620440719D-2, 2.576075398247D-3,         &
        -9.569143876433D-5, 7.900679556534D-1,-4.556957919175D-1, 1.337277737706D-1,-2.157594052042D-2, 1.832563601783D-3,         &
        -6.432286463678D-5, 7.290302365904D-1,-3.945841937680D-1, 1.092502418252D-1,-1.667318620030D-2, 1.341496314853D-3,         &
        -4.464581143111D-5, 6.781821897825D-1,-3.461064436915D-1, 9.076079662805D-2,-1.314681150288D-2, 1.005173704471D-3,         &
        -3.181374631822D-5, 6.349563489690D-1,-3.067739392218D-1, 7.644326048783D-2,-1.054063730153D-2, 7.679506117711D-4,         &
        -2.317563630640D-5, 5.976075476333D-1,-2.742701592908D-1, 6.512719379650D-2,-8.570613370193D-3, 5.964515294181D-4,         &
        -1.720313448459D-5, 4.530821605957D-1,-1.556937202255D-1, 2.621052097467D-2,-2.184050212463D-3, 7.237572572194D-5,         &
        4.314398767018D-1,-1.418342842259D-1, 2.288200151943D-2,-1.828741476402D-3, 5.815166332468D-5, 4.119346702408D-1,          &
        -1.298244601295D-1, 2.010878728234D-2,-1.544113849832D-3, 4.719618664240D-5, 3.942461802274D-1,-1.193370928285D-1,         &
        1.777693657917D-2,-1.313662248549D-3, 3.865502003464D-5, 3.781177456714D-1,-1.101165554215D-1, 1.580007215659D-2,          &
        -1.125279834923D-3, 3.192276744812D-5, 3.633408065001D-1,-1.019602554247D-1, 1.411174419289D-2,-9.699476170226D-4,         &
        2.656330616446D-5, 3.497439218126D-1,-9.470569276499D-2, 1.266017939918D-2,-8.408550675085D-4, 2.225784919574D-5,          &
        3.371845853069D-1,-8.822105128463D-2, 1.140456233287D-2,-7.327946570967D-4, 1.877023896668D-5, 3.255431584494D-1,          &
        -8.239832407718D-2, 1.031237441518D-2,-6.417393667562D-4, 1.592339503986D-5, 3.147180811939D-1,-7.714810368023D-2,         &
        9.357439877093D-3,-5.645414814808D-4, 1.358301324217D-5, 3.046231027165D-1,-7.239608540250D-2, 8.518560948886D-3,          &
        -4.987218951555D-4, 1.164632612927D-5, 2.951839772317D-1,-6.807982796391D-2, 7.778392737741D-3,-4.423078514719D-4,         &
        1.003385659715D-5, 2.863364933588D-1,-6.414655846973D-2, 7.122648855400D-3,-3.937177713169D-4, 8.683627129358D-6,          &
        2.780246155388D-1,-6.055132372497D-2, 6.539470823348D-3,-3.516734769846D-4, 7.546893357357D-6, 2.701996594546D-1,          &
        -5.725581832360D-2, 6.018987049956D-3,-3.151372568482D-4, 6.585092705791D-6, 2.628187673463D-1,-5.422707501601D-2,         &
        5.552907092188D-3,-2.832594125266D-4, 5.767453330918D-6/)


	CONTAINS

	DOUBLE PRECISION FUNCTION HYB_DAW_ERR(X)
!EVALUATES HYBRID ERROR-DAWSON FUNCTION
	IMPLICIT NONE
	INTEGER :: I
	DOUBLE PRECISION, INTENT(IN) :: X 
	DOUBLE PRECISION :: X_INV
	INTEGER :: IMIN, IMAX, ORDER
	HYB_DAW_ERR=0.D0
	IF ( X .GT. 10.D0) THEN
	 X_INV=1.D0/X**2

	 DO I=0,6
	  HYB_DAW_ERR=HYB_DAW_ERR + HDAW_DAW_LARGE_COEF(I)*X_INV**I
	 END DO

	 HYB_DAW_ERR=HYB_DAW_ERR/X

	 RETURN
	END IF

	ORDER=INT(4.D0*X)
	IMIN=POINTERLOW(ORDER)
	IMAX=POINTERUP(ORDER)

	DO I=IMIN,IMAX
	 HYB_DAW_ERR=HYB_DAW_ERR+HDAW_SHORT_COEF(I)*X**(I-IMIN)
	END DO

	RETURN

	END FUNCTION HYB_DAW_ERR

	END MODULE ESP_FUNCT

